from stars.models import Star
from stars.serializers import StarSerializer
from rest_framework.renderers import JSONRenderer
from rest_framework.parsers import JSONParser

serializer = StarSerializer()
print(repr(serializer))

s = Star(star_name='my star')
s.save()
serializer = StarSerializer(s)
serializer.data
content  = JSONRenderer().render(serializer.data)
content
    

"""
class StarSerializer(serializers.ModelSerializer):
    class Meta:
        model = Star
        fields = ['id', 'star_name', 'star_constellation', 'star_type', 'star_distance',
                  'star_mass', 'star_temperature', 'star_period', 'star_turn_speed']    

"""
def add(request):
    if request.method == 'POST':
        form = StarForm(request.POST)
        if form.is_valid():
            new_star_name = form.cleaned_data['star_name']
            new_star_constellation = form.cleaned_data['star_constellation']
            new_star_type = form.cleaned_data['star_type']
            new_star_distance = form.cleaned_data['star_distance']
            new_star_mass = form.cleaned_data['star_mass']
            new_star_temperature = form.cleaned_data['star_temperature']
            new_star_period = form.cleaned_data['star_period']
            new_star_turn_speed = form.cleaned_data['star_turn_speed']

            new_star = Star(
                star_name=new_star_name,
                star_constellation=new_star_constellation,
                star_type=new_star_type,
                star_distance=new_star_distance,
                star_mass=new_star_mass,
                star_temperature=new_star_temperature,
                star_period=new_star_period,
                star_turn_speed=new_star_turn_speed
            )
            new_star.save()
            return render(request, 'stars/add.html', {
                'form': StarForm(),
                'success': True
            })
    else:
        try:
            form = StarForm()
            return render(request, 'stars/add.html', {
            'form': StarForm()
            })
        except(ValueError):
            return HttpResponseRedirect(reverse('index'))
